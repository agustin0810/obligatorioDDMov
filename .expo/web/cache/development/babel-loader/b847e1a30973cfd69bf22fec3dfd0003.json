{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport React, { useState, useEffect } from \"react\";\nimport MyText from \"../../components/MyText\";\nimport DatabaseConnection from \"../../database/database-connection\";\nimport AddButton from \"../../components/AddButton\";\nimport ActionButton from \"../../components/ActionButton\";\nimport { useFocusEffect } from '@react-navigation/native';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar db = DatabaseConnection.getConnection();\n\nvar HomeSupply = function HomeSupply(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      supplies = _useState2[0],\n      setSupplies = _useState2[1];\n\n  useFocusEffect(function () {\n    db.transaction(function (txn) {\n      txn.executeSql('CREATE TABLE IF NOT EXISTS supplies(id INTEGER PRIMARY KEY AUTOINCREMENT, name VARCHAR(20), amount INTEGER, treatmentId INTEGER)', []);\n      txn.executeSql(\"SELECT name FROM sqlite_master WHERE type='table' AND name='supplies'\", [], function (tx, res) {\n        console.log('item:', res.rows.length);\n\n        if (res.rows.length == 0) {\n          txn.executeSql('DROP TABLE IF EXISTS supplies', []);\n          txn.executeSql('CREATE TABLE IF NOT EXISTS supplies(id INTEGER PRIMARY KEY AUTOINCREMENT, name VARCHAR(20), amount INTEGER, treatmentId INTEGER)', []);\n        }\n      });\n      txn.executeSql(\"SELECT * FROM supplies\", [], function (tx, results) {\n        if (results.rows.length > 0) {\n          var temp = [];\n\n          for (var i = 0; i < results.rows.length; ++i) {\n            temp.push(results.rows.item(i));\n          }\n\n          setSupplies(temp);\n        } else {\n          Alert.alert(\"Mensaje\", \"No hay ningún insumo registrado\", [{\n            text: \"Ok\"\n          }], {\n            cancelable: false\n          });\n        }\n      });\n    });\n  });\n\n  var deleteSupply = function deleteSupply(id) {\n    db.transaction(function (tx) {\n      tx.executeSql(\"DELETE FROM supplies WHERE id = ?\", [id], function (tx, results) {\n        console.log(\"results\", results);\n\n        if (results.rowsAffected > 0) {\n          Alert.alert(\"Insumo eliminado\");\n          navigation.navigate(\"HomeScreen\");\n        } else {\n          Alert.alert(\"El insumo no existe\");\n        }\n      });\n    });\n  };\n\n  var getTreatment = function getTreatment(id) {\n    db.transaction(function (tx) {\n      tx.executeSql(\"SELECT * FROM treatments WHERE id = ?\", [id], function (tx, results) {\n        console.log(\"results\", results);\n        var treatment = results.rows.items(0);\n\n        if (results.rowsAffected > 0) {\n          Alert.alert(\"Insumo eliminado\");\n          navigation.navigate(\"HomeScreen\");\n        } else {\n          Alert.alert(\"El insumo no existe\");\n        }\n      });\n    });\n  };\n\n  var listItemView = function listItemView(item) {\n    return _jsxs(View, {\n      style: styles.listItemView,\n      children: [_jsx(MyText, {\n        text: \"Nombre\",\n        style: styles.textL\n      }), _jsx(MyText, {\n        text: item.name,\n        style: styles.textL\n      }), _jsx(MyText, {\n        text: \"Cantidad\",\n        style: styles.textL\n      }), _jsx(MyText, {\n        text: item.amount,\n        style: styles.textL\n      }), _jsx(MyText, {\n        text: \"Tratamiento\",\n        style: styles.textL\n      }), _jsx(MyText, {\n        text: function text() {\n          return getTreatment(item.treatmentId);\n        },\n        style: styles.textL\n      }), _jsx(ActionButton, {\n        style: styles.delBut,\n        btnColor: \"red\",\n        customPress: function customPress() {\n          return deleteSupply(item.id);\n        },\n        title: \"X\"\n      }), _jsx(ActionButton, {\n        style: styles.delBut,\n        btnColor: \"blue\",\n        customPress: function customPress() {\n          return navigation.navigate('UpdateSupply', {\n            id: item.id\n          });\n        },\n        title: \"\\u270E\"\n      })]\n    }, item.id);\n  };\n\n  return _jsx(SafeAreaView, {\n    style: styles.container,\n    children: _jsx(View, {\n      children: _jsxs(View, {\n        children: [_jsx(AddButton, {\n          customPress: function customPress() {\n            return navigation.navigate(\"AddSupply\");\n          }\n        }), _jsx(View, {\n          style: styles.view,\n          children: _jsx(FlatList, {\n            contentContainerStyle: {\n              paddingHorizontal: 20,\n              paddingBottom: 150\n            },\n            data: supplies,\n            keyExtractor: function keyExtractor(index) {\n              return index.toString();\n            },\n            renderItem: function renderItem(_ref2) {\n              var item = _ref2.item;\n              return listItemView(item);\n            }\n          })\n        })]\n      })\n    })\n  });\n};\n\nexport default HomeSupply;\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  viewContainer: {\n    flex: 1,\n    backgroundColor: \"white\"\n  },\n  generalView: {\n    flex: 1\n  },\n  listView: {\n    marginTop: 20\n  },\n  listItemView: {\n    backgroundColor: \"white\",\n    margin: 5,\n    padding: 5,\n    borderRadius: 10\n  },\n  textL: {\n    padding: 5,\n    marginLeft: 10,\n    color: \"black\",\n    alignContent: \"center\",\n    alignItems: \"center\"\n  },\n  flatList: {\n    backgroundColor: 'blue'\n  },\n  delBut: {\n    marginTop: 20\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","MyText","DatabaseConnection","AddButton","ActionButton","useFocusEffect","db","getConnection","HomeSupply","navigation","supplies","setSupplies","transaction","txn","executeSql","tx","res","console","log","rows","length","results","temp","i","push","item","Alert","alert","text","cancelable","deleteSupply","id","rowsAffected","navigate","getTreatment","treatment","items","listItemView","styles","textL","name","amount","treatmentId","delBut","container","view","paddingHorizontal","paddingBottom","index","toString","StyleSheet","create","flex","viewContainer","backgroundColor","generalView","listView","marginTop","margin","padding","borderRadius","marginLeft","color","alignContent","alignItems","flatList"],"sources":["C:/Users/agust/Desktop/OBLIGATORIO DD MOVILES - Leandro Miranda y Agustin Maciel/local/src/screens/Supply/HomeSupply.js"],"sourcesContent":["import { StyleSheet, View, SafeAreaView, FlatList, Alert, ScrollView } from \"react-native\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport MyText from \"../../components/MyText\";\r\nimport DatabaseConnection from \"../../database/database-connection\";\r\nimport AddButton from '../../components/AddButton'\r\nimport ActionButton from '../../components/ActionButton'\r\nimport { useFocusEffect } from '@react-navigation/native';\r\n\r\n\r\nconst db = DatabaseConnection.getConnection();\r\n\r\n\r\nconst HomeSupply = ({ navigation }) => {\r\n  const [supplies, setSupplies] = useState([]);\r\n\r\n  useFocusEffect(() => {\r\n\r\n    db.transaction( (txn) => {\r\n      txn.executeSql(\r\n        'CREATE TABLE IF NOT EXISTS supplies(id INTEGER PRIMARY KEY AUTOINCREMENT, name VARCHAR(20), amount INTEGER, treatmentId INTEGER)',\r\n        []\r\n      );\r\n      txn.executeSql(\r\n        \"SELECT name FROM sqlite_master WHERE type='table' AND name='supplies'\",\r\n        [],\r\n         (tx, res) =>{\r\n\r\n          console.log('item:', res.rows.length);\r\n\r\n          if (res.rows.length == 0) {\r\n            txn.executeSql('DROP TABLE IF EXISTS supplies', []);\r\n            txn.executeSql(\r\n              'CREATE TABLE IF NOT EXISTS supplies(id INTEGER PRIMARY KEY AUTOINCREMENT, name VARCHAR(20), amount INTEGER, treatmentId INTEGER)',\r\n              []\r\n            );\r\n          }\r\n          \r\n        }\r\n      );\r\n      txn.executeSql(`SELECT * FROM supplies`, [], (tx, results) => {\r\n        // validar resultado\r\n        if (results.rows.length > 0) {\r\n          var temp = [];\r\n          for (let i = 0; i < results.rows.length; ++i)\r\n            //Alert.alert(\"paso \" +results.rows.item(i).name)\r\n            temp.push(results.rows.item(i));\r\n          setSupplies(temp);\r\n        } else {\r\n          Alert.alert(\r\n            \"Mensaje\",\r\n            \"No hay ningún insumo registrado\",\r\n            [\r\n              {\r\n                text: \"Ok\",\r\n              },\r\n            ],\r\n            { cancelable: false }\r\n          );\r\n        }\r\n      });\r\n\r\n\r\n\r\n      /*db.transaction((tx) => {\r\n        tx.executeSql(\r\n          `DELETE FROM cars WHERE carCode = ?`,\r\n          [\"\"],\r\n          (tx, results) => {\r\n            console.log(\"results\", results);\r\n            // validar resultado\r\n            if (results.rowsAffected > 0) {\r\n              Alert.alert(\"Auto eliminado\");\r\n            } else {\r\n              Alert.alert(\"El auto no existe\");\r\n            }\r\n          }\r\n        );\r\n      });*/\r\n    });\r\n  });\r\n\r\n  const deleteSupply = (id) => {\r\n    \r\n    db.transaction((tx) => {\r\n      tx.executeSql(\r\n        `DELETE FROM supplies WHERE id = ?`,\r\n        [id],\r\n        (tx, results) => {\r\n          console.log(\"results\", results);\r\n          // validar resultado\r\n          if (results.rowsAffected > 0) {\r\n            Alert.alert(\"Insumo eliminado\");\r\n            navigation.navigate(\"HomeScreen\");\r\n          } else {\r\n            Alert.alert(\"El insumo no existe\");\r\n          }\r\n        }\r\n      );\r\n    });\r\n\r\n  }\r\n  \r\n  const getTreatment = (id) => {\r\n\r\n    db.transaction((tx) => {\r\n      tx.executeSql(\r\n        `SELECT * FROM treatments WHERE id = ?`,\r\n        [id],\r\n        (tx, results) => {\r\n          console.log(\"results\", results);\r\n          // validar resultado\r\n          let treatment = results.rows.items(0);\r\n          if (results.rowsAffected > 0) {\r\n            Alert.alert(\"Insumo eliminado\");\r\n            navigation.navigate(\"HomeScreen\");\r\n          } else {\r\n            Alert.alert(\"El insumo no existe\");\r\n          }\r\n        }\r\n      );\r\n    });\r\n  }\r\n  \r\n\r\n  const listItemView = (item) => {\r\n    return (\r\n      <View key={item.id} style={styles.listItemView}>\r\n        <MyText text=\"Nombre\" style={styles.textL}/>\r\n        <MyText text={item.name} style={styles.textL}/>\r\n\r\n        <MyText text=\"Cantidad\" style={styles.textL}/>\r\n        <MyText text={item.amount} style={styles.textL}/>\r\n\r\n        <MyText text=\"Tratamiento\" style={styles.textL}/>\r\n        <MyText text={() => getTreatment(item.treatmentId)} style={styles.textL}/>\r\n\r\n        <ActionButton style={styles.delBut} btnColor=\"red\" customPress={() => deleteSupply(item.id)} title=\"X\" />\r\n        <ActionButton style={styles.delBut} btnColor=\"blue\" customPress={() => navigation.navigate('UpdateSupply', {id: item.id})} title=\"✎\" />\r\n\r\n      </View>\r\n    );\r\n  };\r\n\r\n\r\n  return (\r\n    <SafeAreaView style={styles.container}>\r\n    <View>\r\n      <View>\r\n          <AddButton customPress={() => navigation.navigate(\"AddSupply\") } />\r\n          <View style={styles.view}>\r\n            <FlatList \r\n            contentContainerStyle={{ paddingHorizontal: 20, paddingBottom: 150 }}\r\n            data={supplies}\r\n            keyExtractor={(index) => index.toString()}\r\n            renderItem={({ item }) => listItemView(item)}\r\n\r\n            />\r\n          </View>\r\n      </View>\r\n    </View>\r\n    </SafeAreaView>\r\n  )\r\n}\r\n\r\nexport default HomeSupply\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n  },\r\n  viewContainer: {\r\n    flex: 1,\r\n    backgroundColor: \"white\",\r\n  },\r\n  generalView: {\r\n    flex: 1,\r\n  },\r\n  listView: {\r\n    marginTop: 20,\r\n  },\r\n  listItemView: {\r\n    backgroundColor: \"white\",\r\n    margin: 5,\r\n    padding: 5,\r\n    borderRadius: 10,\r\n  },\r\n  textL: {\r\n    padding: 5,\r\n    marginLeft: 10,\r\n    color: \"black\",\r\n    alignContent: \"center\",\r\n    alignItems: \"center\",\r\n  },\r\n  flatList: {\r\n    backgroundColor: 'blue'\r\n  },\r\n  delBut: {\r\n    marginTop: 20,\r\n    \r\n  }\r\n})"],"mappings":"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"},"metadata":{},"sourceType":"module"}